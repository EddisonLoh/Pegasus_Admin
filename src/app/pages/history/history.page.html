<ion-header class="ion-no-border" [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button color="primary"></ion-menu-button>
    </ion-buttons>
    <ion-title>Trip History</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-segment value="default" [(ngModel)]="segmentModel" mode="ios">
    <ion-segment-button value="default">
      <ion-label>Completed</ion-label>
    </ion-segment-button>
    <ion-segment-button value="segment">
      <ion-label>Cancelled</ion-label>
    </ion-segment-button>
  </ion-segment>

  <div *ngIf="!isLoading">
    <ion-card class="ion-padding" *ngIf="hasData">
      <ion-searchbar (ionInput)="applyFilter($event)" placeholder="Search trips"></ion-searchbar>

      <ion-grid *ngIf="segmentModel === 'default'">
        <ion-row class="header-row">
          <ion-col>Driver Name</ion-col>
          <ion-col>Driver Phone</ion-col>
          <ion-col>Rider Name</ion-col>
          <ion-col>Rider Phone</ion-col>
          <ion-col>Pickup</ion-col>
          <ion-col>DropOff</ion-col>
          <ion-col>Price</ion-col>
        </ion-row>

        <ion-row *ngFor="let trip of displayedTripHistory">
          <ion-col>{{trip.Driver_name}}</ion-col>
          <ion-col>{{trip.Driver_phone}}</ion-col>
          <ion-col>{{trip.Rider_name}}</ion-col>
          <ion-col>{{trip.Rider_phone}}</ion-col>
          <ion-col>{{trip.pickup}}</ion-col>
          <ion-col>{{trip.dropoff}}</ion-col>
          <ion-col>{{trip.price}}</ion-col>
        </ion-row>
      </ion-grid>

      <ion-grid *ngIf="segmentModel === 'segment'">
        <ion-row class="header-row">
          <ion-col>Driver Name</ion-col>
          <ion-col>Driver Phone</ion-col>
          <ion-col>Rider Name</ion-col>
          <ion-col>Rider Phone</ion-col>
          <ion-col>Pickup</ion-col>
          <ion-col>DropOff</ion-col>
          <ion-col>Price</ion-col>
          <ion-col>Reason</ion-col>
        </ion-row>

        <ion-row *ngFor="let trip of displayedCancelledHistory">
          <ion-col>{{trip.Driver_name}}</ion-col>
          <ion-col>{{trip.Driver_phone}}</ion-col>
          <ion-col>{{trip.Rider_name}}</ion-col>
          <ion-col>{{trip.Rider_phone}}</ion-col>
          <ion-col>{{trip.pickup}}</ion-col>
          <ion-col>{{trip.dropoff}}</ion-col>
          <ion-col>{{trip.price}}</ion-col>
          <ion-col>{{trip.reason}}</ion-col>
        </ion-row>
      </ion-grid>

      <ion-infinite-scroll *ngIf="segmentModel === 'default'" (ionInfinite)="loadMoreTrips($any($event))">
        <ion-infinite-scroll-content
          loadingSpinner="bubbles"
          loadingText="Loading more data...">
        </ion-infinite-scroll-content>
      </ion-infinite-scroll>

      <ion-infinite-scroll *ngIf="segmentModel === 'segment'" (ionInfinite)="loadMoreCancelledTrips($any($event))">
        <ion-infinite-scroll-content
          loadingSpinner="bubbles"
          loadingText="Loading more data...">
        </ion-infinite-scroll-content>
      </ion-infinite-scroll>
    </ion-card>

    <div class="no-data-container" *ngIf="!hasData">
      <ion-img src="../assets/imgs/empty.svg"></ion-img>
      <ion-text color="primary" class="ion-text-center">
        <h2>No Data</h2>
        <p>Book a ride to see Trips</p>
      </ion-text>
    </div>
  </div>

  <ion-grid *ngIf="isLoading">
    <ion-row>
      <ion-col>
        <ion-skeleton-text [animated]="true" style="width: 100%; height: 400px;"></ion-skeleton-text>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>